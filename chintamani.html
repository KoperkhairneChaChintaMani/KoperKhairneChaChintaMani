<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Koperkhairne Cha Chintamani | Ganpati Utsav</title>
  <meta name="description" content="Dynamic official page of Koperkhairne Cha Chintamani Ganpati Utsav with schedule, gallery, announcements, and admin login." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#fff7ed;--paper:#fffaf0;--ink:#3b2f2f;--saffron:#f97316;--gold:#facc15;--rose:#fb7185;--leaf:#16a34a;--maroon:#7c2d12;--radius:22px;--shadow:0 10px 30px rgba(124,45,18,.15)
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{margin:0;font-family:Poppins,system-ui,Arial,sans-serif;color:var(--ink);background:radial-gradient(1200px 700px at 80% -10%,#ffe3c5 0%,transparent 60%),radial-gradient(1000px 600px at -10% 20%,#ffe9d6 0%,transparent 60%),var(--bg)}

    /* HEADER */
    .header{position:sticky;top:0;z-index:50;background:rgba(255,255,255,.8);backdrop-filter:blur(10px);border-bottom:1px solid #0001}
    .header-inner{max-width:1200px;margin:0 auto;display:flex;align-items:center;justify-content:space-between;padding:12px 18px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo{width:38px;height:38px;border-radius:50%;display:grid;place-items:center;background:conic-gradient(from 0deg,var(--saffron),var(--gold),var(--rose),var(--saffron));box-shadow:var(--shadow)}
    .logo svg{width:22px;height:22px;fill:#fff}
    .title{font-weight:800;letter-spacing:.2px;line-height:1.05;color:var(--maroon)}
    .subtitle{display:block;font-size:12px;color:#a16207;font-weight:600}
    .menu{display:flex;gap:6px;flex-wrap:wrap}
    .menu a,.btn{appearance:none;border:none;text-decoration:none;padding:10px 14px;border-radius:14px;font-weight:700;color:#6b4f4f}
    .menu a:hover{background:#fff3d9;color:#8b4513}
    .btn-primary{background:linear-gradient(180deg,#fbbf24,#f59e0b);color:#4c1d07;box-shadow:var(--shadow)}
    .btn-ghost{background:#fff;border:1px solid #f59e0b55;color:#7c2d12}
    .header.login-mode{background:linear-gradient(90deg,#1f2937,#111827);border-bottom:0}
    .header.login-mode .title,.header.login-mode .subtitle,.header.login-mode a,.header.login-mode .btn{color:#fff}

    /* STRIP */
    .ticker{background:linear-gradient(90deg,#fde68a,#fecdd3);border-top:1px solid #f59e0b44;border-bottom:1px solid #f59e0b44}
    .ticker-inner{max-width:1200px;margin:0 auto;padding:8px 18px;display:flex;gap:12px;align-items:center}
    .pill{background:#fff;border:1px dashed #f59e0b88;padding:6px 10px;border-radius:999px;font-weight:700;color:#7c2d12}
    #announcements{display:flex;gap:10px;overflow:auto;scrollbar-width:none}

    /* HERO */
    .hero{max-width:1200px;margin:18px auto 32px;padding:36px 18px 58px;border-radius:var(--radius);background:radial-gradient(900px 260px at 50% 0%,#fff3d9 0%,transparent 70%),linear-gradient(135deg,#fffaf0,#fff0da);box-shadow:var(--shadow);border:1px solid #fde68a7a}
    .hero-grid{display:grid;grid-template-columns:1.1fr .9fr;gap:24px}
    @media (max-width:900px){.hero-grid{grid-template-columns:1fr}}
    h1{font-size:clamp(28px,4.8vw,54px);margin:0 0 8px;color:#7c2d12}
    h2{font-size:clamp(18px,3vw,26px);margin:2px 0 16px;color:#b45309}
    .tagline{font-size:clamp(14px,2.1vw,18px);line-height:1.65;max-width:60ch}
    .badge-row{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
    .badge{background:#fff;border:1px dashed #f59e0b88;padding:8px 12px;border-radius:999px;font-weight:700}
    .idol-card{position:relative;min-height:300px;border-radius:24px;background:radial-gradient(120px 120px at 20% 30%,#fde68a 0 50%,transparent 51%),radial-gradient(160px 120px at 80% 40%,#fecaca 0 50%,transparent 51%),linear-gradient(180deg,#fff,#fff7e6);border:1px solid #fef08a;box-shadow:var(--shadow);display:grid;place-items:center;padding:24px}
    .idol{width:220px;height:220px;filter:drop-shadow(0 10px 16px rgba(124,45,18,.18));animation:float 5.5s ease-in-out infinite}
    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}

    /* SECTIONS */
    section{max-width:1200px;margin:0 auto;padding:28px 18px}
    .section-title{font-size:clamp(22px,3.2vw,34px);margin:6px 0 18px;color:#7c2d12}
    .section-title::after{content:"";display:block;width:90px;height:6px;background:linear-gradient(90deg,#f59e0b,#f43f5e);border-radius:999px;margin-top:8px}
    .cards{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    @media (max-width:900px){.cards{grid-template-columns:1fr 1fr}}
    @media (max-width:620px){.cards{grid-template-columns:1fr}}
    .card{background:var(--paper);border:1px solid #f1dcc5;border-radius:var(--radius);padding:18px;box-shadow:var(--shadow)}
    .muted{color:#7a6960}

    /* SCHEDULE */
    table.schedule{width:100%;border-collapse:collapse;background:#fff;border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow)}
    .schedule th,.schedule td{padding:14px 12px;border-bottom:1px solid #f1dcc5;text-align:left}
    .schedule thead th{background:#fff3d9;color:#7c2d12}
    .schedule tr:hover{background:#fffaf0}

    /* GALLERY */
    .gallery{display:grid;grid-template-columns:repeat(4,1fr);gap:10px}
    @media (max-width:900px){.gallery{grid-template-columns:repeat(3,1fr)}}
    @media (max-width:620px){.gallery{grid-template-columns:repeat(2,1fr)}}
    .gallery a{display:block;aspect-ratio:4/3;border-radius:16px;overflow:hidden;position:relative;background:linear-gradient(180deg,#fff 0,#fde68a 100%)}
    .gallery img{width:100%;height:100%;object-fit:cover;display:block;transition:transform .45s ease}
    .gallery a:hover img{transform:scale(1.06)}
    .lightbox{position:fixed;inset:0;background:rgba(0,0,0,.88);display:none;align-items:center;justify-content:center;z-index:80}
    .lightbox img{max-width:92vw;max-height:86vh;border-radius:18px}

    /* MAP */
    .map-wrap{border-radius:var(--radius);overflow:hidden;box-shadow:var(--shadow);border:1px solid #f1dcc5}
    .map-wrap iframe{width:100%;height:380px;border:0}

    /* CTA */
    .cta-strip{background:linear-gradient(90deg,#fde68a,#fecdd3);padding:20px 18px;border-top:1px solid #f59e0b33;border-bottom:1px solid #f59e0b33}
    .cta-strip .wrap{max-width:1200px;margin:0 auto;display:flex;gap:14px;align-items:center;justify-content:space-between;flex-wrap:wrap}

    /* FOOTER */
    footer{padding:28px 18px 60px;max-width:1200px;margin:0 auto;color:#7a6960}

    /* LOGIN FULL PAGE */
    #loginPage{display:none;min-height:calc(100vh - 60px);background:linear-gradient(180deg,#0f172a,#111827);color:#fff}
    .login-wrap{max-width:1000px;margin:0 auto;padding:36px 18px;display:grid;grid-template-columns:1.1fr .9fr;gap:20px}
    @media (max-width:900px){.login-wrap{grid-template-columns:1fr}}
    .login-card{background:#0b1220;border:1px solid #ffffff22;border-radius:20px;padding:20px;box-shadow:0 10px 30px #0006}
    .login-card h3{margin:6px 0 14px}
    .input{width:100%;padding:12px 14px;border-radius:12px;border:1px solid #ffffff33;background:#0f172a;color:#fff}
    .row{display:flex;gap:10px;align-items:center}
    .login-btn{width:100%;padding:12px 18px;border-radius:14px;border:0;background:linear-gradient(180deg,#fbbf24,#f59e0b);color:#4c1d07;font-weight:800;cursor:pointer}
    .helper{color:#cbd5e1;font-size:14px}
    .error{color:#fecaca;font-weight:700}

    /* ADMIN PANEL */
    #adminPanel{display:none}
    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    @media (max-width:900px){.grid-2{grid-template-columns:1fr}}
    .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;background:#fff;border:1px dashed #f59e0b88;border-radius:10px;padding:2px 8px;color:#7c2d12}

    /* MISC */
    .hidden{display:none !important}
    .right{margin-left:auto}
  </style>
</head>
<body>
  <!-- HEADER -->
  <header id="siteHeader" class="header">
    <div class="header-inner">
      <div class="brand">
        <div class="logo" aria-hidden="true">
          <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2c2 2 2 3 2 4a3 3 0 0 1 4 3c0 1-1 2-1 3 3 1 5 3 5 6 0 3-4 4-10 4S2 21 2 18c0-3 2-5 5-6 0-1-1-2-1-3a3 3 0 0 1 4-3c0-1 0-2 2-4Z"/></svg>
        </div>
        <div>
          <div class="title">Koperkhairne Cha Chintamani</div>
          <span class="subtitle">Ganpati Utsav</span>
        </div>
      </div>
      <nav class="menu" role="navigation" aria-label="Primary">
        <a href="#about">About</a>
        <a href="#highlights">Highlights</a>
        <a href="#schedule">Schedule</a>
        <a href="#seva">Seva</a>
        <a href="#gallery">Gallery</a>
        <a href="#location">Location</a>
        <a href="#contact">Contact</a>
        <button id="loginBtn" class="btn btn-ghost">Login</button>
      </nav>
    </div>
  </header>

  <!-- TICKER / ANNOUNCEMENTS -->
  <div class="ticker" aria-live="polite">
    <div class="ticker-inner">
      <span class="pill">Announcements</span>
      <div id="announcements"></div>
      <span class="right pill" id="countdownPill">Countdown: <span id="countdown"></span></span>
    </div>
  </div>

  <!-- HERO -->
  <header class="hero" role="banner">
    <div class="hero-grid">
      <div>
        <h1>Welcome to Koperkhairne Cha Chintamani</h1>
        <h2>ॐ गं गणपतये नमः</h2>
        <p class="tagline">Join us for vibrant celebrations, soulful aarti, cultural evenings and community seva. Experience devotion, music, prasad and the warmth of our mandal.</p>
        <div class="badge-row" aria-label="Quick facts">
          <span class="badge">Morning Aarti • <span id="amAarti">8:00 AM</span></span>
          <span class="badge">Evening Aarti • <span id="pmAarti">7:30 PM</span></span>
          <span class="badge">Eco‑friendly Visarjan</span>
        </div>
        <div class="badge-row">
          <button class="btn btn-primary" onclick="document.querySelector('#schedule').scrollIntoView({behavior:'smooth'})">🪔 Join Aarti</button>
          <button class="btn btn-ghost" onclick="document.querySelector('#seva').scrollIntoView({behavior:'smooth'})">🙏 Contribute Seva</button>
        </div>
      </div>
      <div>
        <div class="idol-card">
          <!-- Decorative Ganesha -->
          <svg class="idol" viewBox="0 0 200 200" role="img" aria-label="Lord Ganesha">
            <defs>
              <radialGradient id="g" cx="50%" cy="50%" r="60%">
                <stop offset="0%" stop-color="#fff7ed"/>
                <stop offset="100%" stop-color="#fbbf24"/>
              </radialGradient>
            </defs>
            <circle cx="100" cy="100" r="80" fill="url(#g)"/>
            <path d="M70 90c0 18 14 30 30 30s30-12 30-30" stroke="#7c2d12" stroke-width="7" fill="none" stroke-linecap="round"/>
            <path d="M90 78c-8-8-16-12-28-12M138 66c-12 0-20 4-28 12" stroke="#7c2d12" stroke-width="6" fill="none" stroke-linecap="round"/>
            <circle cx="88" cy="96" r="6" fill="#7c2d12"/>
            <circle cx="112" cy="96" r="6" fill="#7c2d12"/>
            <path d="M100 110c10 0 20 6 20 16 0 10-10 18-20 18s-20-8-20-18c0-10 10-16 20-16Z" fill="#ef4444" opacity=".85"/>
            <path d="M100 34c4 6 6 12 6 18 0 8-4 16-6 18-2-2-6-10-6-18 0-6 2-12 6-18Z" fill="#7c2d12"/>
          </svg>
        </div>
      </div>
    </div>
  </header>

  <!-- ABOUT -->
  <section id="about" aria-labelledby="about-title">
    <h3 id="about-title" class="section-title">About the Mandal</h3>
    <div class="cards">
      <div class="card">
        <h4>Our Story</h4>
        <p class="muted">Founded by devotees of Navi Mumbai, <strong>Koperkhairne Cha Chintamani</strong> celebrates unity, culture and eco‑friendly practices. Every year we welcome thousands for darshan, aarti and community service.</p>
      </div>
      <div class="card">
        <h4>Eco‑Friendly Ideals</h4>
        <p class="muted">We promote clay idols, plastic‑free decor and responsible visarjan. Join our cleanliness drives and tree plantation initiatives.</p>
      </div>
      <div class="card">
        <h4>Volunteer With Us</h4>
        <p class="muted">Be part of the seva teams for crowd management, prasad distribution, first‑aid and cultural programs. All ages welcome!</p>
      </div>
    </div>
  </section>

  <!-- HIGHLIGHTS -->
  <section id="highlights" aria-labelledby="highlights-title">
    <h3 id="highlights-title" class="section-title">Utsav Highlights</h3>
    <div class="cards">
      <div class="card">
        <h4>🪔 Daily Aarti</h4>
        <p class="muted">Morning: <span id="amAarti2">8:00 AM</span> • Evening: <span id="pmAarti2">7:30 PM</span></p>
      </div>
      <div class="card">
        <h4>🎶 Cultural Evenings</h4>
        <p class="muted">Bhajans, dhol‑tasha, dance & music showcasing local talent.</p>
      </div>
      <div class="card">
        <h4>🍃 Community Seva</h4>
        <p class="muted">Blood donation drives, annadan and cleanliness campaigns.</p>
      </div>
    </div>
  </section>

  <!-- SCHEDULE -->
  <section id="schedule" aria-labelledby="schedule-title">
    <h3 id="schedule-title" class="section-title">Festival Schedule</h3>
    <div class="card" style="padding:0">
      <table class="schedule" aria-describedby="schedule-note">
        <thead>
          <tr>
            <th>Day</th>
            <th>Program</th>
            <th>Timings</th>
            <th>Venue</th>
          </tr>
        </thead>
        <tbody id="scheduleBody">
          <tr>
            <td>Day 1</td>
            <td>Pran Pratishtha & Aarti</td>
            <td><span class="am">8:00 AM</span> & <span class="pm">7:30 PM</span></td>
            <td>Mandal Pandal</td>
          </tr>
          <tr>
            <td>Day 2–9</td>
            <td>Bhajans, Cultural Programs</td>
            <td>6:30 PM onwards</td>
            <td>Main Stage</td>
          </tr>
          <tr>
            <td>Final Day</td>
            <td>Visarjan Procession (Eco‑friendly)</td>
            <td>From 4:00 PM</td>
            <td>Procession Route</td>
          </tr>
        </tbody>
      </table>
      <p id="schedule-note" class="muted" style="padding:12px 14px">Exact dates will be announced by the mandal. Follow our social channels for updates.</p>
    </div>
  </section>

  <!-- SEVA -->
  <section id="seva" aria-labelledby="seva-title">
    <h3 id="seva-title" class="section-title">Seva & Donations</h3>
    <div class="cards">
      <div class="card">
        <h4>Contribute</h4>
        <p class="muted">Your support fuels annadan, medical camps and cultural activities.</p>
        <ul>
          <li><strong>UPI:</strong> <code>ADD-OFFICIAL-UPI@upi</code></li>
          <li><strong>Account:</strong> <code>Mandal Name • Bank • IFSC</code></li>
        </ul>
      </div>
      <div class="card">
        <h4>QR Code</h4>
        <div style="height:180px;border:2px dashed #f59e0b;border-radius:12px;display:grid;place-items:center;background:#fff">Add your payment QR here</div>
      </div>
      <div class="card">
        <h4>Volunteer Signup</h4>
        <p class="muted">Message us with your name, contact and area of interest. We’ll get back to you with briefing details.</p>
        <a class="btn btn-ghost" href="#contact">Become a Volunteer</a>
      </div>
    </div>
  </section>

  <!-- GALLERY -->
  <section id="gallery" aria-labelledby="gallery-title">
    <h3 id="gallery-title" class="section-title">Gallery</h3>
    <div class="gallery" id="galleryGrid">
      <a href="#"><img alt="Idol decoration" src="https://images.unsplash.com/photo-1566554273541-37f20f5b724e?q=80&w=1200&auto=format&fit=crop" /></a>
      <a href="#"><img alt="Aarti lamps" src="https://images.unsplash.com/photo-1565637233510-063eb2de9d8f?q=80&w=1200&auto=format&fit=crop" /></a>
      <a href="#"><img alt="Dhol tasha" src="https://images.unsplash.com/photo-1552274015-6b2a7d0b4a18?q=80&w=1200&auto=format&fit=crop" /></a>
      <a href="#"><img alt="Prasad modaks" src="https://images.unsplash.com/photo-1600831736110-1e77b42cd2ca?q=80&w=1200&auto=format&fit=crop" /></a>
      <a href="#"><img alt="Decor lights" src="https://images.unsplash.com/photo-1501594907352-04cda38ebc29?q=80&w=1200&auto=format&fit=crop" /></a>
      <a href="#"><img alt="Devotees" src="https://images.unsplash.com/photo-1582478193173-bde2a1d4b071?q=80&w=1200&auto=format&fit=crop" /></a>
      <a href="#"><img alt="Rangoli" src="https://images.unsplash.com/photo-1603197601865-b6bb3cbe3729?q=80&w=1200&auto=format&fit=crop" /></a>
      <a href="#"><img alt="Visarjan" src="https://images.unsplash.com/photo-1506318039043-94ce8273b311?q=80&w=1200&auto=format&fit=crop" /></a>
    </div>
    <div class="lightbox" id="lightbox" onclick="this.style.display='none'">
      <img id="lightboxImg" alt="preview" />
    </div>
  </section>

  <!-- CTA STRIP -->
  <div class="cta-strip">
    <div class="wrap">
      <div>
        <strong>Be part of the celebration!</strong><br>
        Share this page with friends & family and invite them for darshan.
      </div>
      <a class="btn btn-primary" href="#contact">Contact the Mandal</a>
    </div>
  </div>

  <!-- LOCATION -->
  <section id="location" aria-labelledby="location-title">
    <h3 id="location-title" class="section-title">Location</h3>
    <div class="map-wrap">
      <iframe loading="lazy" allowfullscreen referrerpolicy="no-referrer-when-downgrade"
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15083.884348548133!2d73.000000!3d19.100000!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3be7c1b9a9a2cdbf%3A0x7b8c51e2a7fa9d7!2sKopar%20Khairane%2C%20Navi%20Mumbai%2C%20Maharashtra!5e0!3m2!1sen!2sin!4v1680000000000"></iframe>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact" aria-labelledby="contact-title">
    <h3 id="contact-title" class="section-title">Contact</h3>
    <div class="cards">
      <div class="card">
        <h4>Mandal Office</h4>
        <p class="muted">
          Address: <em>Near [Landmark], Koperkhairne, Navi Mumbai</em><br>
          Phone: <a href="tel:+910000000000">+91 00000 00000</a><br>
          Email: <a href="mailto:info@kccmandal.org">info@kccmandal.org</a>
        </p>
      </div>
      <div class="card">
        <h4>Public Relations</h4>
        <p class="muted">
          Name: <strong>Mahendra Bhosale</strong><br>
          Phone: <a href="tel:+917718094480">+91 77180 94480</a>
        </p>
      </div>
      <div class="card">
        <h4>Follow Us</h4>
        <p class="muted">Add official Instagram, Facebook and YouTube links.</p>
      </div>
    </div>
  </section>

  <!-- ADMIN PANEL (appears after login) -->
  <section id="adminPanel" aria-labelledby="admin-title">
    <h3 id="admin-title" class="section-title">Admin Panel</h3>
    <div class="cards">
      <div class="card">
        <h4>Update Aarti Timings</h4>
        <div class="grid-2">
          <label>Morning Aarti <input id="amInput" class="input" type="text" placeholder="e.g. 8:15 AM"></label>
          <label>Evening Aarti <input id="pmInput" class="input" type="text" placeholder="e.g. 7:45 PM"></label>
        </div>
        <div style="margin-top:10px" class="row">
          <button class="btn btn-primary" id="saveAarti">Save Timings</button>
          <span class="muted">Tip: Use formats like <span class="kbd">7:30 PM</span></span>
        </div>
      </div>
      <div class="card">
        <h4>Announcements</h4>
        <div class="row">
          <input id="announceInput" class="input" type="text" placeholder="Type a new announcement & hit Add">
          <button class="btn btn-ghost" id="addAnnouncement">Add</button>
        </div>
        <ul id="announceList" style="margin-top:10px"></ul>
      </div>
      <div class="card">
        <h4>Gallery (add image URL)</h4>
        <div class="row">
          <input id="imgInput" class="input" type="url" placeholder="https://...">
          <button class="btn btn-ghost" id="addImg">Add Image</button>
        </div>
      </div>
    </div>
  </section>

  <!-- LOGIN PAGE (separate header style) -->
  <section id="loginPage" aria-labelledby="login-title">
    <div class="login-wrap">
      <div>
        <h2 id="login-title" style="margin:0 0 10px">Admin Login</h2>
        <p class="helper">Access is restricted. Use the provided credentials to manage timings, announcements and gallery.</p>
        <div class="login-card">
          <h3>Sign in</h3>
          <label>User ID<br><input id="uid" class="input" type="text" autocomplete="username" placeholder="Enter User ID"></label>
          <div style="height:10px"></div>
          <label>Password<br><input id="pwd" class="input" type="password" autocomplete="current-password" placeholder="Enter Password"></label>
          <div style="height:14px"></div>
          <button class="login-btn" id="doLogin">Login</button>
          <div id="loginError" class="error" style="display:none;margin-top:10px">Invalid credentials</div>
          <p class="helper" style="margin-top:14px">Demo creds → <span class="kbd">User: Chintamani</span> • <span class="kbd">Pass: Chintamani@2025</span></p>
        </div>
      </div>
      <div class="login-card">
        <h3>What you can do</h3>
        <ul>
          <li>Update Aarti timings shown across the page</li>
          <li>Add announcements to the live ticker</li>
          <li>Append images to the gallery</li>
        </ul>
        <p class="helper">This is a client‑side demo. Data is saved in your browser only (localStorage).</p>
      </div>
    </div>
  </section>

  <footer>
    <div>© <span id="year"></span> Koperkhairne Cha Chintamani Mandal • With blessings of Bappa 🙏</div>
  </footer>

  <script>
    // --- Config ---
    const CREDS = { user: 'Chintamani', pass: 'Chintamani@2025' };
    const STORAGE_KEYS = { auth:'kcc_auth', am:'kcc_am', pm:'kcc_pm', ann:'kcc_ann', gal:'kcc_gal' };

    // --- Utilities ---
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));

    function setHeaderMode(mode){
      const header = $('#siteHeader');
      if(mode==='login') header.classList.add('login-mode'); else header.classList.remove('login-mode');
    }

    function route(){
      const hash = location.hash.toLowerCase();
      const login = $('#loginPage');
      const admin = $('#adminPanel');
      if(hash==='#login'){
        setHeaderMode('login');
        login.style.display='block';
        admin.style.display = isAuthed()? 'block':'none';
        window.scrollTo({top:0,behavior:'instant'});
      }else{
        setHeaderMode();
        login.style.display='none';
        admin.style.display = isAuthed()? 'block':'none';
      }
    }

    function isAuthed(){ return localStorage.getItem(STORAGE_KEYS.auth)==='1'; }
    function requireAuth(){ if(!isAuthed()) location.hash = '#login'; }

    // --- Auth ---
    $('#loginBtn').addEventListener('click', ()=>{ location.hash='#login'; });
    $('#doLogin').addEventListener('click', ()=>{
      const u = $('#uid').value.trim();
      const p = $('#pwd').value;
      if(u===CREDS.user && p===CREDS.pass){
        localStorage.setItem(STORAGE_KEYS.auth,'1');
        $('#loginError').style.display='none';
        document.title = 'Admin • Koperkhairne Cha Chintamani';
        route();
        alert('Logged in as '+u);
      }else{
        $('#loginError').style.display='block';
      }
    });

    // --- Admin actions ---
    $('#saveAarti').addEventListener('click', ()=>{
      requireAuth();
      const am = $('#amInput').value.trim();
      const pm = $('#pmInput').value.trim();
      if(am) localStorage.setItem(STORAGE_KEYS.am, am);
      if(pm) localStorage.setItem(STORAGE_KEYS.pm, pm);
      applyAarti();
      alert('Aarti timings updated');
    });

    $('#addAnnouncement').addEventListener('click', ()=>{
      requireAuth();
      const t = $('#announceInput').value.trim();
      if(!t) return;
      const arr = JSON.parse(localStorage.getItem(STORAGE_KEYS.ann) || '[]');
      arr.unshift(t);
      localStorage.setItem(STORAGE_KEYS.ann, JSON.stringify(arr));
      $('#announceInput').value='';
      renderAnnouncements();
    });

    $('#addImg').addEventListener('click', ()=>{
      requireAuth();
      const url = $('#imgInput').value.trim();
      if(!url) return;
      const arr = JSON.parse(localStorage.getItem(STORAGE_KEYS.gal) || '[]');
      arr.unshift(url);
      localStorage.setItem(STORAGE_KEYS.gal, JSON.stringify(arr));
      $('#imgInput').value='';
      renderGalleryExtras();
    });

    // --- Apply Aarti timings everywhere ---
    function applyAarti(){
      const am = localStorage.getItem(STORAGE_KEYS.am) || '8:00 AM';
      const pm = localStorage.getItem(STORAGE_KEYS.pm) || '7:30 PM';
      ['#amAarti','#amAarti2'].forEach(id=>{ const el=$(id); if(el) el.textContent = am; });
      ['#pmAarti','#pmAarti2'].forEach(id=>{ const el=$(id); if(el) el.textContent = pm; });
      $$('#scheduleBody .am').forEach(el=>el.textContent=am);
      $$('#scheduleBody .pm').forEach(el=>el.textContent=pm);
    }

    // --- Announcements ticker ---
    function renderAnnouncements(){
      const wrap = $('#announcements');
      wrap.innerHTML='';
      const arr = JSON.parse(localStorage.getItem(STORAGE_KEYS.ann) || '[]');
      if(arr.length===0){
        const d = document.createElement('span');
        d.className='muted';
        d.textContent = 'No announcements yet. Admins can add some from the panel.';
        wrap.appendChild(d);
        return;
      }
      arr.forEach(txt=>{
        const pill=document.createElement('span');
        pill.className='pill';
        pill.textContent=txt;
        wrap.appendChild(pill);
      });
    }

    // --- Gallery lightbox + extras from storage ---
    function renderGalleryExtras(){
      const grid = $('#galleryGrid');
      const arr = JSON.parse(localStorage.getItem(STORAGE_KEYS.gal) || '[]');
      // remove previously added extras
      $$('.extra', grid).forEach(n=>n.remove());
      arr.forEach(url=>{
        const a=document.createElement('a');
        a.className='extra';
        a.href='#';
        const img=new Image();
        img.alt='Added by admin';
        img.src=url;
        a.appendChild(img);
        grid.prepend(a);
      });
      bindLightbox();
    }

    function bindLightbox(){
      const lb = $('#lightbox');
      const lbImg = $('#lightboxImg');
      $$('#galleryGrid a').forEach(a=>{
        a.addEventListener('click', e=>{ e.preventDefault(); lbImg.src=a.querySelector('img').src; lb.style.display='flex'; });
      });
    }

    // --- Countdown (set target date below) ---
    const FESTIVAL_START = new Date(new Date().getFullYear(), 8, 7, 6, 0, 0); // Sept 7, 6:00 AM (example)
    function tick(){
      const now = new Date();
      let diff = FESTIVAL_START - now;
      if(diff < 0) diff = 0;
      const d = Math.floor(diff/86400000);
      const h = Math.floor((diff%86400000)/3600000);
      const m = Math.floor((diff%3600000)/60000);
      const s = Math.floor((diff%60000)/1000);
      $('#countdown').textContent = `${d}d ${h}h ${m}m ${s}s`;
      requestAnimationFrame(()=>setTimeout(tick, 1000));
    }

    // --- Session status in header ---
    function updateLoginButton(){
      const btn = $('#loginBtn');
      if(isAuthed()){
        btn.textContent='Logged in • Logout';
        btn.onclick = ()=>{ localStorage.removeItem(STORAGE_KEYS.auth); route(); updateLoginButton(); };
      }else{
        btn.textContent='Login';
        btn.onclick = ()=>{ location.hash='#login'; };
      }
    }

    // --- Init ---
    document.getElementById('year').textContent = new Date().getFullYear();
    window.addEventListener('hashchange', route);
    route();
    applyAarti();
    renderAnnouncements();
    renderGalleryExtras();
    bindLightbox();
    updateLoginButton();
    tick();
  </script>
</body>
</html>
